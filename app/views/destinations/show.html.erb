<% provide(:title, "#{@destination.name}") %>
<div class="container destination-show-wrapper">
  <h1><%= @destination.name %></h1>

  <div class="destination-show-edit-delete">
    <% if current_user == @destination.user %>
      <div class="destination-show-edit">
        <%= link_to "Edit", edit_destination_path(@destination), class: "btn btn-primary" %>
      </div><!-- .destination-show-edit -->
    <% end %>
    <% if current_user.admin? || (current_user == @destination.user) %>
      <div class="destination-show-delete">
        <%= link_to "Delete", destination_path(@destination), method: :delete, class: 'btn btn-primary', data: { confirm: "Are you sure?" } %>
      </div><!-- .destination-show-delete -->
    <% end %>
  </div>

  <div class="destination-show-map-wrapper">
    <div id="map"></div>

    <script type="text/javascript">
      handler = Gmaps.build('Google');
      handler.buildMap({ provider: { scrollwheel: false }, internal: {id: 'map'}}, function(){
        markers = handler.addMarkers(<%= raw @marker.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        handler.getMap().setZoom(16);
      });
    </script>
  </div><!-- .destination-show-map-wrapper -->

  <div class="row destination-show-info-detail-wrapper">
    <div class="col-md-4 destination-show-info">
      <div class="destination-show-picture">
        <%= image_tag @destination.picture.thumb400.url %>
      </div><!-- .destination-show-picture -->

      <div class="destination-show-info-text">
        <div class="destination-show-user">
          <div class="destination-show-icon">
            <%= link_to @destination.user, class: "destination-list-icon-link" do %>
              <%= gravatar_for(@destination.user, size: 50) %>
            <% end %>
          </div><!-- .destination-show-icon -->
          <h3><%= link_to @destination.user.name, @destination.user %></h3>
        </div><!-- .destination-show-user -->

        <div class="destination-show-favorite-timestamp">
          <%= render "users/favorite_form" %>
          <div class="destination-show-timestamp">
            <%= time_ago_in_words(@destination.created_at) %>前
          </div><!-- .dextination-show-timestamp -->
        </div><!-- .destination-show-favorite-timestamp -->
      </div><!-- .destination-show-info-text -->
    </div><!-- .col-md-4 .destination-show-picture -->

    <div class="col-md-8 destination-show-detail">
      <div class="destination-show-description">
        <p><%= @destination.description %></p>
      </div>
      <p class="destination-list-country-name"><i class="fa fa-map-marker"></i> <%= @country.country_name %></p>
      <p class="destination-region"><i class="fas fa-globe"></i> <%= @country.region %></p>
      <p class="destination-spot"><i class="far fa-flag"></i> <%= @destination.spot %></p>
      <p class="destination-expense"><i class="fas fa-calculator"></i> <%= @destination.expense %></p>
      <p class="destination-season"><i class="fas fa-suitcase-rolling"></i> <%= @destination.season %>月</p>
      <p class="destination-experience"><i class="fas fa-hiking"></i> 体験: <%= @destination.experience %></p>
      <% if @airline.nil? %>
        <p class="destination-airline_name"><i class="fas fa-plane"></i> 航空会社: 未使用</p>
      <% else %>
        <p class="destination-airline_name"><i class="fas fa-plane"></i> 航空会社: <%= @airline.airline_name %></p>
        <p class="destination-alliance"><i class="far fa-handshake"></i> アライアンス: <%= @airline.alliance %></p>
      <% end %>
      <p class="destination-food"><i class="fas fa-utensils"></i> 食べ物: <%= @destination.food %></p>
    </div><!-- .col-md-8 .destination-show-detail -->
  </div><!-- .row .destination-show-picture-info-wrapper -->

  <div class="destination-comment-wrapper">
    <%= render "comments/feed_comments" %>
    <%= render "comments/new" %>
  </div><!-- .destination-comment-wrapper -->

</div><!-- container .destination-show-wrapper -->
